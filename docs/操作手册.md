# 稳定性保持系统操作手册

## 1. 系统概述

稳定性保持系统是一套用于控制和监控稳定平台的自动化系统，通过与PLC设备集成，实现对平台升降、水平调整和刚柔支撑等功能的精确控制。系统提供基于HTTP的REST API接口，允许上层应用和用户通过网络远程控制和监控平台状态。

本手册旨在指导操作人员正确使用稳定性保持系统，包括系统启动、关闭、日常操作、状态监控以及故障处理等内容。

## 2. 系统启动与关闭

### 2.1 系统启动

1. 打开终端，进入系统安装目录
2. 执行以下命令启动系统：
   ```
   ./stability_server
   ```
3. 如果系统已配置为服务，可以使用以下命令启动：
   ```
   sudo systemctl start stability-system
   ```
4. 通过日志确认系统是否成功启动：
   ```
   sudo systemctl status stability-system
   ```
   或查看日志文件：
   ```
   tail -f /var/log/stability-system/stability_system.log
   ```

### 2.2 系统关闭

1. 如果是通过终端启动的，在终端中按下`Ctrl+C`组合键
2. 如果是作为服务运行，执行以下命令：
   ```
   sudo systemctl stop stability-system
   ```

### 2.3 系统状态检查

系统启动后，可以通过以下方式检查系统状态：

1. 使用Web浏览器访问系统健康检查接口：
   ```
   http://<系统IP地址>:8080/api/v1/system/status
   ```
   如果返回正常JSON数据，则表示系统运行正常

2. 查看系统日志文件，确认是否有错误信息

## 3. 日常操作指南

### 3.1 设备状态监控

1. **查看设备状态**

   使用Web浏览器或API工具访问以下URL，获取设备的实时状态：
   ```
   http://<系统IP地址>:8080/api/v1/system/status
   ```

   返回数据示例：
   ```json
   {
     "msg": "success",
     "operationMode": "自动",
     "emergencyStop": "复位",
     "oilPumpStatus": "启动",
     "cylinderState": "下降停止",
     "platform1State": "上升停止",
     "platform2State": "下降停止",
     "heaterStatus": "启动",
     "coolingStatus": "停止",
     "alarmStatus": "正常",
     "levelingStatus": "停止",
     "cylinderPressure": 12.34,
     "platform1Pressure": 5.67,
     "platform2Pressure": 5.78,
     "tiltAngle": 0.05,
     "platformPosition": 120,
     "timestamp": 1634567890123
   }
   ```

   主要状态字段说明：
   - `operationMode`：操作模式，"自动"或"手动"
   - `emergencyStop`：急停状态，"复位"或"急停"
   - `oilPumpStatus`：油泵状态，"停止"或"启动"
   - `cylinderState`：刚柔缸状态
   - `platform1State`/`platform2State`：升降平台状态
   - `alarmStatus`：报警状态，"正常"或具体报警信息

2. **检查报警信息**

   特别关注返回数据中的`alarmStatus`字段，如果不为"正常"，表示系统存在报警，需要及时处理。

### 3.2 支撑控制操作

1. **执行刚性支撑操作**

   发送POST请求到以下接口：
   ```
   http://<系统IP地址>:8080/api/v1/control/support
   ```

   请求数据：
   ```json
   {
     "taskId": 12345,
     "defectId": 67890,
     "state": "rigid"
   }
   ```

   其中：
   - `taskId`：任务ID，可自定义，用于跟踪任务
   - `defectId`：缺陷ID，可自定义
   - `state`：支撑状态，"rigid"表示刚性支撑

2. **执行柔性复位操作**

   发送POST请求到相同接口，但将`state`值改为"flexible"：
   ```json
   {
     "taskId": 12346,
     "defectId": 67891,
     "state": "flexible"
   }
   ```

### 3.3 平台高度控制

1. **平台上升操作**

   发送POST请求到以下接口：
   ```
   http://<系统IP地址>:8080/api/v1/control/platform/height
   ```

   请求数据：
   ```json
   {
     "taskId": 12347,
     "defectId": 67892,
     "platformNum": 1,
     "state": "up"
   }
   ```

   其中：
   - `platformNum`：平台编号，1或2
   - `state`：控制状态，"up"表示上升

2. **平台下降操作**

   发送POST请求到相同接口，但将`state`值改为"down"：
   ```json
   {
     "taskId": 12348,
     "defectId": 67893,
     "platformNum": 1,
     "state": "down"
   }
   ```

### 3.4 平台调平控制

1. **启动调平操作**

   发送POST请求到以下接口：
   ```
   http://<系统IP地址>:8080/api/v1/control/platform/horizontal
   ```

   请求数据：
   ```json
   {
     "taskId": 12349,
     "defectId": 67894,
     "platformNum": 1,
     "state": "level"
   }
   ```

2. **停止调平操作**

   发送POST请求到相同接口，但将`state`值改为"level_reset"：
   ```json
   {
     "taskId": 12350,
     "defectId": 67895,
     "platformNum": 1,
     "state": "level_reset"
   }
   ```

### 3.5 电源控制

1. **开启电源**

   发送POST请求到以下接口：
   ```
   http://<系统IP地址>:8080/api/v1/control/power
   ```

   请求数据：
   ```json
   {
     "state": "on"
   }
   ```

2. **关闭电源**

   发送POST请求到相同接口，但将`state`值改为"off"：
   ```json
   {
     "state": "off"
   }
   ```

### 3.6 电机控制

1. **启动电机**

   发送POST请求到以下接口：
   ```
   http://<系统IP地址>:8080/api/v1/control/motor
   ```

   请求数据：
   ```json
   {
     "state": "start"
   }
   ```

2. **停止电机**

   发送POST请求到相同接口，但将`state`值改为"stop"：
   ```json
   {
     "state": "stop"
   }
   ```

### 3.7 操作模式切换

1. **切换到自动模式**

   发送POST请求到以下接口：
   ```
   http://<系统IP地址>:8080/api/v1/control/mode
   ```

   请求数据：
   ```json
   {
     "mode": "auto"
   }
   ```

2. **切换到手动模式**

   发送POST请求到相同接口，但将`mode`值改为"manual"：
   ```json
   {
     "mode": "manual"
   }
   ```

### 3.8 错误上报

当发现系统异常时，可以通过以下接口上报错误：

发送POST请求到以下接口：
```
http://<系统IP地址>:8080/api/v1/report/error
```

请求数据：
```json
{
  "alarm": "液压系统压力异常",
  "level": "warning",
  "source": "operator",
  "timestamp": 1634567890123
}
```

其中：
- `alarm`：报警信息，必填
- `level`：报警级别，可选（"info"/"warning"/"error"/"fatal"）
- `source`：报警来源，可选
- `timestamp`：时间戳，可选，默认为当前时间

## 4. 操作流程示例

### 4.1 标准启动流程

1. 启动系统服务
2. 检查系统状态，确认与PLC设备连接正常
3. 开启电源 (如果尚未开启)
4. 启动电机 (如果尚未启动)
5. 设置操作模式 (通常为"自动"模式)
6. 执行平台调平操作，确保平台水平
7. 系统进入待命状态，可以接收控制指令

### 4.2 标准关闭流程

1. 确保所有操作已完成，平台处于安全状态
2. 停止电机
3. 关闭电源
4. 关闭系统服务

### 4.3 刚性支撑应用场景

**场景**：需要对设备进行稳定支撑以进行检修

**操作流程**：
1. 检查设备状态，确保系统处于正常状态
2. 发送平台上升指令，将平台升高到合适位置
3. 确认平台上升到位后，发送调平指令，确保平台水平
4. 完成调平后，发送刚性支撑指令，执行刚性支撑
5. 监控支撑状态，确保支撑操作成功完成
6. 进行设备检修作业
7. 作业完成后，发送柔性复位指令，解除刚性支撑
8. 发送平台下降指令，将平台恢复到初始位置

## 5. 故障处理指南

### 5.1 常见故障及解决方法

| 故障现象 | 可能原因 | 解决方法 |
|---------|---------|---------|
| 系统无法启动 | 1. 系统文件损坏<br>2. 端口被占用<br>3. 权限问题 | 1. 重新安装系统<br>2. 修改配置文件中的端口<br>3. 以管理员权限运行 |
| 无法连接PLC | 1. PLC设备未启动<br>2. 网络连接问题<br>3. PLC地址配置错误 | 1. 检查PLC设备电源<br>2. 检查网络连接<br>3. 修改配置文件中的PLC地址和端口 |
| API请求失败 | 1. 系统未正常运行<br>2. 请求参数错误<br>3. 服务器内部错误 | 1. 检查系统运行状态<br>2. 检查请求参数格式<br>3. 查看系统日志 |
| 控制指令无响应 | 1. PLC通信中断<br>2. 设备处于异常状态<br>3. 操作权限不足 | 1. 重新建立PLC连接<br>2. 复位设备状态<br>3. 切换操作模式 |
| 平台无法上升/下降 | 1. 液压系统压力不足<br>2. 电机未启动<br>3. 急停按钮被按下 | 1. 检查液压系统<br>2. 启动电机<br>3. 复位急停按钮 |
| 无法实现刚性支撑 | 1. 平台位置不正确<br>2. 液压系统故障<br>3. 刚柔缸卡滞 | 1. 调整平台位置<br>2. 检查液压系统<br>3. 检查刚柔缸状态 |
| 系统报警频繁 | 1. 传感器故障<br>2. 油液温度异常<br>3. 液位异常 | 1. 检查并更换传感器<br>2. 检查温度控制系统<br>3. 检查液压油液位 |

### 5.2 紧急情况处理

1. **设备异常运动**
   - 立即按下紧急停止按钮
   - 切断电源
   - 记录异常情况
   - 联系技术支持

2. **系统崩溃**
   - 关闭系统
   - 尝试重启
   - 检查系统日志
   - 如无法恢复，联系技术支持

3. **液压系统泄漏**
   - 停止所有操作
   - 关闭电源和电机
   - 处理泄漏
   - 检查液压系统

### 5.3 报警信息及处理方法

| 报警信息 | 报警含义 | 处理方法 |
|---------|---------|---------|
| "油温低" | 液压油温度过低 | 检查加热系统，延长预热时间 |
| "油温高" | 液压油温度过高 | 开启冷却系统，减少连续工作时间 |
| "液位低" | 液压油液位过低 | 添加液压油至正常液位 |
| "液位高" | 液压油液位过高 | 降低液压油液位 |
| "滤芯堵" | 油路滤芯堵塞 | 更换滤芯 |
| "PLC通信超时" | 与PLC通信中断 | 检查网络连接，重新连接PLC |
| "压力异常" | 系统压力超出正常范围 | 检查液压系统，可能需要降压或补压 |
| "平台倾斜过大" | 平台水平度超出安全范围 | 执行调平操作，检查水平传感器 |

## 6. 系统维护

### 6.1 日常维护

1. **日志检查**
   - 定期检查系统日志，关注错误和警告信息
   - 日志文件位置：`logs/stability_system.log`
   
2. **状态监控**
   - 定期检查设备状态，确保各部件工作正常
   - 特别关注液压系统压力、温度等参数

3. **备份配置**
   - 定期备份系统配置文件
   - 配置文件位置：`config/config.ini`和`config/logging.conf`

### 6.2 定期维护

1. **系统更新**
   - 定期检查系统更新，安装最新版本
   - 更新前先备份配置文件和日志

2. **PLC连接测试**
   - 定期测试系统与PLC设备的通信
   - 验证所有控制指令能正常执行

3. **性能评估**
   - 检查系统响应时间
   - 监控资源占用情况，确保系统稳定运行

### 6.3 预防性维护

1. **硬件检查**
   - 检查服务器硬件状态
   - 确保网络设备正常工作

2. **数据库维护**
   - 如果系统使用数据库，定期进行数据清理
   - 确保数据库容量充足

3. **安全检查**
   - 确保系统运行在安全的网络环境中
   - 定期修改访问密码（如有）

## 7. 安全注意事项

1. **操作权限**
   - 只有经过培训的操作人员才能使用系统
   - 严格控制API访问权限

2. **紧急停止**
   - 确保紧急停止设备随时可用
   - 所有操作人员必须熟悉紧急停止程序

3. **设备安全**
   - 在设备下方工作时，必须确保支撑系统处于安全状态
   - 严禁在未完成支撑操作前进入工作区域

4. **系统操作**
   - 严格按照操作流程执行各项操作
   - 避免同时执行多个冲突的操作
   - 操作完成后及时检查结果

5. **数据安全**
   - 保护系统配置和操作日志
   - 避免未授权人员访问系统

## 8. 附录

### 8.1 API接口参考

详细的API接口说明请参阅[API接口文档](API接口文档.md)。

### 8.2 状态码参考

| 状态码 | 含义 |
|-------|-----|
| 200 | 请求成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 |
| 404 | 资源不存在 |
| 500 | 服务器内部错误 |

### 8.3 常用工具

1. **API测试工具**
   - Postman：用于测试API接口
   - cURL：命令行API测试工具

2. **日志分析工具**
   - Vim/Nano：用于查看日志文件
   - grep：用于日志搜索

3. **网络诊断工具**
   - ping：测试网络连通性
   - telnet：测试端口连通性

### 8.4 常用命令

1. **查看系统状态**
   ```
   curl -X GET http://<系统IP地址>:8080/api/v1/system/status
   ```

2. **执行刚性支撑**
   ```
   curl -X POST http://<系统IP地址>:8080/api/v1/control/support \
     -H "Content-Type: application/json" \
     -d '{"taskId": 12345, "defectId": 67890, "state": "rigid"}'
   ```

3. **平台上升操作**
   ```
   curl -X POST http://<系统IP地址>:8080/api/v1/control/platform/height \
     -H "Content-Type: application/json" \
     -d '{"taskId": 12345, "defectId": 67890, "platformNum": 1, "state": "up"}'
   ```

4. **查看系统日志**
   ```
   tail -f /var/log/stability-system/stability_system.log
   ```

5. **检查系统服务状态**
   ```
   systemctl status stability-system
   ```

### 8.5 联系方式

如遇到无法解决的问题，请联系技术支持：

- **技术支持电话**：400-123-4567
- **技术支持邮箱**：support@example.com
- **服务时间**：周一至周五 9:00-17:30

### 8.6 版本信息

本操作手册适用于稳定性保持系统V1.0及以上版本。

| 版本 | 日期 | 更新内容 |
|------|------|---------|
| 1.0.0 | 2024-3-8 | 初始版本 |
| 1.1.0 | 2024-3-10 | 增加平台2控制说明 |
| 2.0.0 | 2024-03-11 | 完善操作流程，增加故障处理指南 |